// filename: execve-ls-extended-shellcode.c
// author: lawly
// description: invokes '//bin/ls --group-directories-first -l -t' via execve syscall
//
// gcc -m32 -fno-stack-protector -z execstack -o execve-ls-extended-shellcode execve-ls-extended-shellcode.c

#include <stdio.h>
#include <string.h>

unsigned char code[] = \
	"\x31\xd2\x52\x66\x68\x2d\x74\x89\xe7\x52\x66\x68\x2d\x6c\x89\xe6\x52\x6a"
    "\x74\x68\x66\x69\x72\x73\x68\x69\x65\x73\x2d\x68\x63\x74\x6f\x72\x68\x64"
    "\x69\x72\x65\x68\x6f\x75\x70\x2d\x68\x2d\x2d\x67\x72\x89\xe0\x52\x68\x6e"
    "\x2f\x6c\x73\x68\x2f\x2f\x62\x69\x89\xe3\x52\x57\x56\x50\x53\x89\xe1\x31"
    "\xc0\xb0\x0b\xcd\x80";



int main() {
    printf("shellcode length: %d\n", strlen(code));
    int (*ret)() = (int(*)())code;
    ret();
}
