; filename: execve-stack.nasm
; author: lawly
; description: invokes execve pointing to /bin/bash using stack technique
;
; ADDR 0x00000000 ////bin/bash 0x00000000
; ^    ^          ^
; |    |          |
; ECX  EDX        EBX
; 
; ./execve-stack
; [xxx@thinkpad 5-execve-stack]$ ps
;   PID TTY          TIME CMD
;  6048 pts/2    00:00:02 zsh
; 10825 pts/2    00:00:00 bash
; 10826 pts/2    00:00:00 ps
;

global _start

section .text
_start:

    xor eax, eax
    push eax                ; PUSH first null dword

    push 0x68736162
    push 0x2f6e6962
    push 0x2f2f2f2f         ; PUSH filename ////bin/bash (12)

    mov ebx, esp            ; EBX points to null terminated filename

    push eax                ; PUSH null dword for envp
    mov edx, esp            ; pointer to null dword

    push ebx                ; push argv[] onto stack
    mov ecx, esp            ; move &argv[0] into ECX

    mov al, 0xb             
    int 0x80                ; invoke execve syscall